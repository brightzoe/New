### 数据在计算机中存储中的表示

浮点数一般使用 8 个字节表示，64bit
最左是符号，然后十一位为指数

- 指数范围-1023-1024, 指数部分使用原码存储，原码范围 0-2047,0 表示-1023
- 指数不用补码：从左到右扫描即可比较大小。
- 浮点数不够精确则更多用于对比大小，提高大小比较效率
- 程序中很少判断两个浮点数相等，更多判断他们的差的绝对值是否小于某个精度。小数部分最高精度 Number.EPSILON
  不存储底数的整数部分，因为底数的整数部分总是 1, 可以让二进制状态有效位数为 53 位
- 有效位数 53 位，可以表达的最大精确数 2\*\*53-1 为 `Number.MAX_SAFE_INTEGER`. 大于这个范围的数是可以表示的，但不能保证精确，溢出的位会被截断
- 整数部分使用的越多，小数部分有效位数越少。即数值越大，小数部分的精度越低。

IEEE754 标准：二进制浮点顺运算标准

- 双精度浮点数使用 8 字节表示，指数部分 11bit, 底数 62bit
- 单精度浮点数使用 4 字节表示，指数部分 8bit, 底数 23bit

### URL 网址

- 格式： 协议：//主机地址+目录路径+参数
- 常用协议
  ![常用协议](https://cdn.jsdelivr.net/gh/brightzoe/img/xieyi.png)

### 浏览器及其内核

![](https://cdn.jsdelivr.net/gh/brightzoe/img/browser.png)

## 万维网是如何工作的

![客户端和服务器](https://cdn.jsdelivr.net/gh/brightzoe/img/20200105191449.png)

- 网络连接：允许你在互联网上发送和接受数据。基本上和你家到商店的街道差不多
- TCP/IP: 传输控制协议和因特网互连协议是定义数据如何传输的通信协议。这就像你去商店购物所使用的交通方式，比如汽车或自行车。
- DNS: 域名系统服务器像是一本网站通讯录。浏览器需要找到存放你想要的网页的服务器，才能发送 HTTP 请求到正确的地方。就像你要知道商店的地址才能到达那。
- HTTP: 超文本传输协议是一个定义客户端和服务器间交流的语言的协议（protocol ）。就像你下订单时所说的话一样。
- 组成文件：一个网页由许多文件组成，就像商店里不同的商品一样。这些文件有两种类型：
  - 代码 : 网页大体由 HTML、CSS、JavaScript 组成，不过你会在后面看到不同的技术。
  - 资源 : 这是其他组成网页的东西的集合，比如图像、音乐、视频、Word 文档、PDF 文件。

### 发生了什么？

当你在浏览器里输入一个网址时（在我们的例子里就是走向商店的路上时）；

1. 浏览器在域名系统（DNS）服务器上找出存放网页的服务器的实际地址（找出商店的位置）。
2. 浏览器发送 HTTP 请求信息到服务器来请拷贝一份网页到客户端（你走到商店并下订单）。所有在客户端和服务器之间传递的数据都是通过互联网使用 TCP/IP 协议传输的。
3. 服务器同意客户端的请求后，会返回一个“200 OK”信息，意味着“你可以查看这个网页，给你～”，然后开始将网页的文件以数据包的形式传输到浏览器（商店给你商品，你将商品带回家）。
4. 浏览器将数据包聚集成完整的网页然后将网页呈现给你（商品到了你的门口 —— 新东西，好棒！）。

### DNS 解析

真正的网址是一串数字，比如 10.230.217.105，这叫 IP 地址，代表互联网上一个独特的位置。但并不好记忆，DNS 就是将域名与实际的 IP 地址相匹配的特殊服务器，达到让人使用域名，路由器使用 IP 地址的目的。
例如 IP Checker 可以通过域名查找 IP 地址。
解析器向 DNS 服务器发出查询，接收服务器返回的响应消息，响应消息包含查询到的 IP 地址。

#### DNS 解析器

解析器包含在操作系统的 Socket 库(网络开发的一种标准库，其中包含的程序组件可以让其他的应用调用操作系统的网络功能)中。

- 调用解析器：`gethostbyname("www.xx.xx")`
- 计算机内部：控制流程转移 ![](https://i.loli.net/2020/07/07/AJBEzOsc7MYndhD.png)

#### DNS 服务器

DNS 服务器的基本工作就是根据需要查询的域名和记录类型查找相关的记录，并向客户端返回响应消息。
其中，来自客户端的查询消息包含以下 3 种信息。

- 域名
  服务器、邮件服务器（邮件地址中@后面的部分）的名称
- Class
  在最早设计 DNS 方案时，DNS 在互联网以外的其他网络中的应用也被考虑到了，而 Class 就是用来识别网络的信息。不过，如今除了互联网并没有其他的网络了，因此 Class 的值永远是代表互联网的 IN
- 记录类型
  表示域名对应何种类型的记录。例如，当类型为 A 时，表示域名对应的是 IP 地址；当类型为 MX 时，表示域名对应的是邮件服务器。对于不同的记录类型，服务器向客户端返回的信息也会不同。
  类型：PTR,CNAME,NS,SOA...

DNS 服务器上事先保存有前面这 3 种信息对应的记录数据。
DNS 服务器中的所有信息都是按照域名以分层次的结构来保存的。域名中右边的部分层级高。
上级 DNS 服务器保管着所有下级 DNS 服务器的信息。
com、jp：顶级域，上面还有一层：. 根域，一般省略，但真实存在，根域的 DNS 服务器信息保存在互联网所有 DNS 服务器中。
DNS 服务器的缓存功能，加快服务器的响应。

#### IP 地址

IP 地址和现实中的地址一样，不能重复。
局域网都是基于 TCP/IP 思路设计的。TCP/IP 的结构就是由一些小的子网，通过路由器连接起来组成一个大的网络。这里的子网可以理解为用集线器连接起来的几台计算机，我们将它看作一个单位，称为子网。将子网通过路由器连接起来，就形成了一个网络。
在 IP 地址的规则中，网络号和主机号连起来总共是 32 比特，8 比特为 1 组。
IP 地址的表示方法：![IP 地址的表示方法](https://i.loli.net/2020/07/07/bJ7BuNd9Om6TlWe.png)
利用附加信息来区分网络号和主机号，这个附加信息叫子网掩码。

**IP 地址的主机号**

- 全 0：表示整个子网
- 全 1：表示向子网上所有设备发送包，即“广播”

#### 委托协议栈向 Web 服务器发送消息

向操作系统内部的协议栈发出委托时，需要按照指定的顺序来调用 Socket 库中的程序组件。
收发数据的操作分为若干个阶段，可以大致总结为以下 4 个。
（1）创建套接字（创建套接字阶段）
（2）将管道连接到服务器端的套接字上（连接阶段）
- 描述符：应用程序用来识别套接字的机制
- IP地址和端口号：客户端和服务器之间用来识别对方套接字的机制
（3）收发数据（通信阶段）
（4）断开管道并删除套接字（断开阶段）

### 协议栈和网卡
浏览器、邮件等一般应用程序收发数据时用TCP;DNS查询等收发较短的控制数据时用UDP。
套接字中记录了用于控制通信操作的各种控制信息，协议栈则需要根据这些信息判断下一步的行动。
显示套接字 `netstat -ano`


### 数据包是什么意思？

基本上，当数据在 Web 上传输时，是以成千上万的小数据块的形式传输的。大量不同的用户都可以同时下载同一个网页。如果网页以单个大的数据块形式传输，一次就只有一个用户下载，无疑会让 Web 非常没有效率并且失去很多乐趣。

## 计算机网络是典型的分层结构

- 物理层
- 链路层
- 网络层
- 传输层
- 应用层

### 物理层

- 设备间的物理连接，可以有线也可以无线。网线/WiFi/4G
- 解决信号的调制与解调，转换数字信号和模拟信号
- 网卡：拥有 MAC 地址，使得用户可以通过网线或无线相互连接
- 曼彻斯特编码：加倍信号跳变频率，网络设备支持的频率固定，用来减半传播数据的大小。
- `ipconfig /all`查看网络配置

### 链路层

将比特数据流进行分组，完成从比特到以太网帧的服务（令牌环 / 总线型结构 / 交换机三种传播结构）

- 以太网帧：链路层传播的数据包
- 总线型结构：所有的网点和同一条总线连接
- 交换机：一台机器，多个接口连接网络设备，可以识别每台连接的网络设备的 MAC 地址
- ARP 协议：address resolution protocol(地址解析协议), 将 ip 地址转化为 MAC 地址并记录对应关系，命令行 arp -a 可查看所有记录
  抓包软件：wireshark，抓取以太网帧数据包
  ARP 欺骗：假冒广播寻找的 IP 地址；网管交换机：记录每个网口对应的 ip 地址，MAC 地址，防止欺骗
  ARP 风暴： 高频率发送 ARP 广播，占用网络资源
  ping: 在命令行输入 ping ip 地址，查看和目标地址是否可以互动
  子网掩码：转化为 2 进制，前面全 1，后面全 0,1 对应的 ip 地址部分是网络号，0 对应主机号；网络号相同的在同一个局域网里面；如 192.168.88.2/255.255.255.0 192.168.88.2/24
  网络地址：ip 地址与子网掩码做与运算，结果就是网络地址

### 网络层

多个网络点之间的中转和传输，机器到机器

- 路由器：多个接口连接不同的子局域网，每个接口的 IP 地址（网关地址）不一样；
- 路由表：网关发过来的 ip 地址会进入路由器内部的路由表，其指导后续的网络传播方向 ；
- 家用路由器（NAT 路由器 Network address transition）： 和上面的路由器不一样；里面是一个路由器和一个交换机，相当于具有链路层和网络层功能。
- IP 分片 /IP 重组：IP 有关数据大小（IP 总长度）大于以太网帧负载，需要分开传输后再重组
- 0.0.0.0 ：代表任意的 ip 地址，不能作为目的地址使用
- 127.x.x.x 以 127 开头的 ip 地址都指向本机
- IP 报头：记录 ip 地址有关信息，本身储存在以太网帧负载里面
  - 版本（IPv4/IPv6），首部长度，总长度 标识（第几个分片）
  - 协议（解析 ip 地址的协议），首部校验和（哈希校验）
  - 源 IP 地址 / 目标 IP 地址
  - 数据（可选）
  - 生成时间（TTL）: IP 包头在网络中最多可以中转的次数，每遇到路由器中转一次减一，到 0 路由器就不传播扔掉该数据（路由会返回给发送者在哪一个路由器地址被扔掉，利用该特性可以追踪路由 cmd - tracert baidu.com），可以防止环状循环传播； - 在传播过程中 TTL 和首部校验和会变化
    -ICMP 协议：每个路由回复数据传播状态所要用到的协议

### 传输层

网络数据的传输 (UDP/TCP 协议），端口到端口（应用程序到应用程序）
应用层
